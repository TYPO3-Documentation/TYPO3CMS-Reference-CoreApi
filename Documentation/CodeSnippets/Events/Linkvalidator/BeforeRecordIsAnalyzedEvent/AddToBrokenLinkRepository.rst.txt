.. Generated by https://github.com/TYPO3-Documentation/t3docs-codesnippets 
.. Extracted from EXT:examples/Classes/EventListener/LinkValidator/CheckExternalLinksToLocalPagesEventListener.php

.. code-block:: php
   :caption: EXT:examples/Classes/EventListener/LinkValidator/CheckExternalLinksToLocalPagesEventListener.php

   use TYPO3\CMS\Linkvalidator\Repository\BrokenLinkRepository;
   
   final class CheckExternalLinksToLocalPagesEventListener
   {
       private const LOCAL_DOMAIN = 'example.org';
       private const TABLE_NAME = 'tt_content';
       private const FIELD_NAME = 'bodytext';
   
       private BrokenLinkRepository $brokenLinkRepository;
   
       private function matchUrl(string $foundUrl, array $record, array &$results): void
       {
           if (str_contains($foundUrl, self::LOCAL_DOMAIN)) {
               $this->addItemToBrokenLinkRepository($record, $foundUrl);
               $results[] = $record;
           }
       }
   
       private function addItemToBrokenLinkRepository(array $record, string $foundUrl): void
       {
           $link = [
               'record_uid' => $record['uid'],
               'record_pid' => $record['pid'],
               'language' => $record['sys_language_uid'],
               'field' => self::FIELD_NAME,
               'table_name' => self::TABLE_NAME,
               'url' => $foundUrl,
               'last_check' => time(),
               'link_type' => 'external',
           ];
           $this->brokenLinkRepository->addBrokenLink($link, false, [
               'errorType' => 'exception',
               'exception' => 'Do not link externally to ' . self::LOCAL_DOMAIN,
               'errno' => 1661517573,
           ]);
       }
   }
   